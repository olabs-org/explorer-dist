import{u as q,o as ce,a as de,b as t,c as o,r as m,f as pe,d as A,e as d,g as z,w,h as ve,_ as R,F as N,i as T,j as g,k as D,t as h,l as j,m as ee,n as I,p as fe,q as te,v as _e,s as i,x as S,P as se,y as me,z as he,A as E,B as ae,E as K,C as ye,D as ke,G as ge,H as xe,I as be,J as we,K as $e,L as Se,M as Ae,N as Oe,O as De,Q as Ie,R as Ne}from"./index.3627c245.js";import{u as Le,C as Re,i as Te,a as Be,b as Ve,c as je,d as We,g as W,S as Pe,_ as Fe}from"./Spinner.d0340664.js";function Q(p,l){const u={};return p.query.asset&&(u.asset=p.query.asset),l&&l.value&&(u.lastInputsROWID=l.value.lastInputsROWID,u.lastOutputsROWID=l.value.lastOutputsROWID),u}const Ee=["innerHTML"],qe={__name:"AddLinksToAddresses",props:{text:String},setup(p){const l=q();function u(e){return e.replace(/&quot;([A-Z0-9]{32})&quot;/g,function(s,x){return`&quot;<a class="addr link link-hover text-blue-500" href="/address/${x}">${x}</a>&quot;`})}function v(e){const{target:s}=e;s&&s.tagName==="A"&&s.className.includes("addr")&&(e.preventDefault(),l.push({path:`/address/${s.innerText}`}))}return ce(()=>{window.addEventListener("click",v,!0)}),de(()=>{window.removeEventListener("click",v,!0)}),(e,s)=>(t(),o("div",{innerHTML:u(p.text)},null,8,Ee))}},ze={__name:"BalancesChart",props:["name","data"],setup(p){const l=p;Le([Te,Be,Ve,je,We]);const u=q(),v=m({tooltip:{trigger:"item",position:"top",formatter:function(s){return`${s.data.name} - $${pe(s.data.value)} (${s.percent}%)`}},series:[{name:l.name,type:"pie",radius:"80%",minShowLabelAngle:20,cursor:"default",label:{position:"inner",fontSize:11},labelLine:{show:!1},data:l.data,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});function e(s){const{name:x,event:f}=s;f.target.type==="tspan"&&u.push(`/asset/${x}`)}return(s,x)=>(t(),A(d(Re),{class:"chart",option:v.value,onClick:e},null,8,["option"]))}},Me=D(" \xA0("),Ce=D(") "),Ge={__name:"UnspentOutputs",props:["unspent"],setup(p){const{t:l}=z();return(u,v)=>(t(),A(R,{title:d(l)("unspent"),closed:!0},{default:w(()=>[ve([p.unspent],()=>(t(),o("div",{class:"grid gap-1"},[(t(!0),o(N,null,T(p.unspent,e=>(t(),o("div",{key:e.output_id},[g(j,{type:"unit",link:e.unit},{default:w(()=>[D(h(e.unit),1)]),_:2},1032,["link"]),Me,g(ee,{amount:e.amount,decimals:e.assetDecimals,"is-asset":!0},null,8,["amount","decimals"]),g(j,{type:"asset",link:d(W)(e.asset,e.assetName)},{default:w(()=>[D(h(d(W)(e.asset,e.assetName)),1)]),_:2},1032,["link"]),Ce]))),128))])),v,0)]),_:1},8,["title"]))}},He={key:0,class:"mt-2 mb-4"},Ue={class:"text-xs ml-2"},Ye={class:"list-disc list-outside ml-5 sm:ml-10"},Je={key:0},Xe={key:1},Ke={class:"py-4"},Qe={__name:"StateVars",props:["stateVars","storageSize"],setup(p){const l=p,u=30,{t:v}=z(),e=m(""),s=m([]),x=m(0);let f=0;function $(){f=0;const a=[];x.value=Object.keys(l.stateVars).length;for(let k in l.stateVars){if(f===u)break;const _=String(l.stateVars[k]);if(!e.value||k.includes(e.value)||_.includes(e.value)){const b={key:k};try{b.type="json",b.value=me(he(_))}catch{b.type="text",b.value=_}a.push(b),f++}}s.value=a}return I(e,()=>{$()}),fe(()=>{$()}),(a,k)=>(t(),o(N,null,[x.value>u?(t(),o("div",He,[te(i("input",{class:"input input-bordered input-xs focus:outline-0",type:"text","onUpdate:modelValue":k[0]||(k[0]=_=>e.value=_),placeholder:"Search"},null,512),[[_e,e.value]]),i("span",Ue,h(d(v)("tooManyVars")),1)])):S("",!0),i("ul",Ye,[(t(!0),o(N,null,T(s.value,_=>(t(),o("li",{key:_.key},[i("span",null,h(_.key)+": ",1),_.type==="json"?(t(),o("div",Je,[g(se,null,{default:w(()=>[D(h(_.value),1)]),_:2},1024)])):(t(),o("span",Xe,h(_.value),1))]))),128))]),i("div",Ke,h(d(v)("storageSize"))+": "+h(p.storageSize)+" bytes",1)],64))}};async function Z(p,l,u){const{wsConnected:v}=E(ae());let e="info";if(u.lastInputsROWID&&(e="next_page"),v.value)return u.address=l,new Promise(s=>{if(e==="next_page"){p.emit(K.LoadNextPageAddressTransactions,u,s);return}p.emit(K.GetAddressData,u,s)});{const{data:s}=await ye.get(`/api/address/${l}/${e}`,{params:u});return s}}const Ze={class:"w-full bg-white absolute h-full p-1 sm:p-4 pt-4",style:{"z-index":"1100"}},et={class:"text-right pr-4"},tt={key:0,class:"text-center"},st={key:1,class:"mt-14 text-center"},at={key:2},nt={class:"mt-10 font-bold"},lt={key:0,class:"font-normal text-sm"},ut=["href"],ot={class:"block lg:flex"},rt={class:"flex-auto"},it={class:"list-disc list-outside ml-10"},ct={class:"pt-4 grid gap-1"},dt={class:"mt-4"},pt=["selected"],vt=["value","selected"],ft={class:"flex justify-center"},_t={__name:"Address",setup(p){const{lastUnit:l,view:u}=E(ae()),{rates:v}=E(ke()),e=ge("socket.io"),{t:s}=z(),x=q(),f=xe(),$=m(!1),a=m({}),k=m(!1),_=m({lastInputsROWID:0,lastOutputsROWID:0}),b=m(!0),B=m(!1),O=m("all"),M=m(null),C=m(null),L=m([]),G=m(!1),{height:H}=be(),{height:P}=we(C),{y:U}=$e(),ne=Se(()=>`${!k.value&&a.value.address?`Address ${a.value.address} transactions and portfolio | `:""}${Ae}`);Oe({title:ne});function Y(n){let y=[],c=null;if(!Object.keys(v.value).length)return[];for(let r in n){const F=n[r].balance;let X=n[r].assetDecimals||0;const ie=n[r].assetName||"GBYTE";if(r==="bytes"&&(r="GBYTE",X=9),!v.value[`${r}_USD`])continue;let V=F/10**X;if(V=Number((v.value[`${r}_USD`]*V).toFixed(2)),r==="GBYTE"){c={value:V,name:"GBYTE"};continue}y.push({value:V,name:ie})}return y.sort((r,F)=>F.value-r.value),!c&&y.length&&(c={value:0,assetName:"GBYTE"}),c&&(y=[c,...y]),y}function le(n){if(b.value=!0,B.value=!1,L.value=[],n.notFound){k.value=!0,$.value=!0;return}a.value=n,G.value=!n.testnet&&n.arrAaResponses!==void 0,L.value=Y(n.objBalances),_.value={lastInputsROWID:n.newLastInputsROWID,lastOutputsROWID:n.newLastOutputsROWID},k.value=!1,$.value=!0}function ue(n){B.value=n.end,_.value={lastInputsROWID:n.newLastInputsROWID,lastOutputsROWID:n.newLastOutputsROWID},M.value.addNewTransactions(n.unitAssets,n.objTransactions),b.value=!0}async function oe(){if(!f.params.address)return;const n=Q(f);f.query.asset&&(O.value=f.query.asset),$.value=!1;const y=await Z(e,f.params.address,n);le(y)}async function J(){if(B.value)return;const n=Q(f,_);b.value=!1;const y=await Z(e,f.params.address,n);y.notFound||ue(y)}I(()=>[f.params.address,f.query.asset||"all"].join("_"),oe,{immediate:!0}),I(U,()=>{$.value&&b.value&&U.value+H.value+100>=P.value&&!k.value&&J()}),I(P,()=>{$.value&&b.value&&P.value<H.value&&!k.value&&J()}),I(O,()=>{O.value!==f.query.asset&&x.push({query:{asset:O.value}})}),I(v,()=>{a.value&&(L.value=Y(a.value.objBalances))});function re(){return l.value?x.push({path:"/"+l.value}):x.push({path:"/"})}return(n,y)=>(t(),o("div",Ze,[i("div",{class:"max-w-6xl mx-auto w-full text-sm md:text-base",ref_key:"el",ref:C},[i("div",et,[i("a",{onClick:re,class:"link link-hover text-blue-500"},h(d(s)("closeButton")),1)]),$.value?S("",!0):(t(),o("div",tt,[g(Pe,{class:"w-20 h-20 inline-block"})])),k.value?(t(),o("div",st," No transactions were found for this address ")):$.value?(t(),o("div",at,[i("div",nt,h(a.value.address),1),G.value?(t(),o("div",lt,[i("a",{href:"https://aa-stats.obyte.org/address/"+a.value.address,target:"_blank",class:"link link-hover text-blue-500"},"View Autonomous Agent stats (TVL, turnover) ",8,ut)])):S("",!0),i("div",ot,[i("div",rt,[a.value.definition?(t(),A(R,{key:0,class:"pt-1.5",title:d(s)("labelDefinition"),closed:!0},{default:w(()=>[g(se,null,{default:w(()=>[g(qe,{text:d(De)(JSON.parse(a.value.definition))},null,8,["text"])]),_:1})]),_:1},8,["title"])):S("",!0),a.value.objStateVars?(t(),A(R,{key:1,class:"pt-1.5",title:d(s)("labelStateVars"),closed:!0},{default:w(()=>[g(Qe,{"state-vars":a.value.objStateVars,"storage-size":a.value.storage_size},null,8,["state-vars","storage-size"])]),_:1},8,["title"])):S("",!0),a.value.arrAasFromTemplate?(t(),A(R,{key:2,class:"pt-1.5",title:d(s)("labelAasFromTemplate"),closed:!0},{default:w(()=>[i("ul",it,[(t(!0),o(N,null,T(a.value.arrAasFromTemplate,c=>(t(),o("li",{key:c.address},[g(j,{type:"address",link:c.address},{default:w(()=>[D(h(c.address),1)]),_:2},1032,["link"])]))),128))])]),_:1},8,["title"])):S("",!0),a.value.arrAaResponses?(t(),A(R,{key:3,class:"pt-1.5",title:d(s)("labelAaResponses"),closed:!0},{default:w(()=>[g(Ie,{"arr-aa-responses":a.value.arrAaResponses},null,8,["arr-aa-responses"])]),_:1},8,["title"])):S("",!0),i("div",ct,[(t(!0),o(N,null,T(a.value.objBalances,(c,r)=>(t(),o("div",{key:r,class:"flex"},[g(ee,{amount:c.balance,decimals:c.assetDecimals,"is-asset":!0,rates:!1},null,8,["amount","decimals"]),g(j,{type:"asset",link:d(W)(r,c.assetName)},{default:w(()=>[D(h(d(W)(r,c.assetName)),1)]),_:2},1032,["link"])]))),128))]),i("div",dt,[i("span",null,h(d(s)("transactionsInAssets"))+": ",1),te(i("select",{class:"select select-bordered select-sm py-0","onUpdate:modelValue":y[0]||(y[0]=c=>O.value=c)},[i("option",{value:"all",selected:O.value==="all"},h(d(s)("labelAll")),9,pt),(t(!0),o(N,null,T(a.value.objBalances,(c,r)=>(t(),o("option",{key:r,value:r,selected:O.value===r},h(c.assetName||r),9,vt))),128))],512),[[Ne,O.value]])]),d(u)==="UTXO"?(t(),A(Ge,{key:4,class:"mt-4",unspent:a.value.unspent},null,8,["unspent"])):S("",!0)]),i("div",ft,[L.value.length?(t(),A(ze,{key:0,class:"h-80 w-80",data:L.value,name:"Balances"},null,8,["data"])):S("",!0)])]),g(Fe,{class:"mt-12",ref_key:"PL",ref:M,"unit-assets":a.value.unitAssets,"obj-transactions":a.value.objTransactions,address:a.value.address,view:d(u)},null,8,["unit-assets","obj-transactions","address","view"])])):S("",!0)],512)]))}},yt={__name:"AddressView",setup(p){return(l,u)=>(t(),A(_t))}};export{yt as default};
