import{g as F,b as n,c as i,s as y,t as k,j as _,w as R,k as h,e as b,l as C,u as z,I as V,r,f as ee,p as te,n as D,d as B,A as W,B as M,E as P,C as G,G as Z,J,o as se,h as ae,_ as ne,F as A,i as le,m as S,x as H,H as oe,D as ue,K as re,L as ie,M as ce,N as de}from"./index.3627c245.js";import{u as ve,i as fe,a as me,b as he,c as pe,d as _e,C as ye,p as E,S as ke,_ as we}from"./Spinner.d0340664.js";const be={key:0},$e=y("span",{class:"font-bold"},"Bytes",-1),ge=h(" - native asset"),De=[$e,ge],Oe={key:1},xe={class:"font-bold"},He={key:0},Ie=h(" - view on "),Ne=["href"],Re=h(" and "),Le={key:1},Ce=h(" - view "),Se={key:2},We={class:"font-bold"},Pe=h(" - view "),Ae={__name:"NameBlock",props:["assetUnit","name","url","urlName"],setup(a){const{t:s}=F();return(o,c)=>a.assetUnit==="bytes"?(n(),i("div",be,De)):a.name?(n(),i("div",Oe,[y("span",xe,k(a.name),1),a.url?(n(),i("span",He,[Ie,y("a",{href:a.url,target:"_blank",class:"link link-hover text-blue-500"},k(a.urlName),9,Ne),Re,_(C,{type:"unit",link:a.assetUnit},{default:R(()=>[h(k(b(s)("labelDefinition").toLowerCase()),1)]),_:1},8,["link"])])):(n(),i("span",Le,[Ce,_(C,{type:"unit",link:a.assetUnit},{default:R(()=>[h(k(b(s)("labelDefinition").toLowerCase()),1)]),_:1},8,["link"])]))])):(n(),i("div",Se,[y("span",We,k(a.assetUnit),1),Pe,_(C,{type:"unit",link:a.assetUnit},{default:R(()=>[h(k(b(s)("labelDefinition").toLowerCase()),1)]),_:1},8,["link"])]))}},Fe={__name:"HoldersChart",props:["name","symbol","data"],setup(a,{expose:s}){const o=a;ve([fe,me,he,pe,_e]);const c=z(),{width:l}=V(),u=r(),f=r(!1),g=r({tooltip:{trigger:"item",position:"top",formatter:function(t){return`${t.data.name}<br/>${ee(t.data.value)} ${o.symbol} (${t.percent}%)`}},series:[{name:o.name,type:"pie",radius:"80%",minShowLabelAngle:4,cursor:"default",data:o.data,label:{cursor:"default"},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});function v(){u.value.resize()}function O(t){const{name:m,event:p}=t;if(p.target.type==="tspan"){if(m==="Others"){u.value.chart.getZr().setCursorStyle("default");return}u.value.chart.getZr().setCursorStyle("pointer")}}function e(t){const{name:m,event:p}=t;p.target.type!=="tspan"||m==="Others"||c.push(`/address/${m}`)}function w(){u.value.setOption({series:[{radius:"50%"}]})}function $(){u.value.setOption({series:[{radius:"80%"}]})}return te(()=>{if(f.value)return w();$()}),D(l,()=>{l.value>640&&f.value?f.value=!1:l.value<=640&&!f.value&&(f.value=!0)},{immediate:!0}),D(f,()=>{if(!!u.value){if(f.value)return w();$()}}),s({resize:v}),(t,m)=>(n(),B(b(ye),{ref_key:"chart",ref:u,class:"chart",option:g.value,onMousemove:O,onClick:e},null,8,["option"]))}};async function Be(a,s,o){const{wsConnected:c}=W(M());if(c.value)return o.asset=s,new Promise(l=>{a.emit(P.LoadNextPageAssetHolders,o,l)});{const{data:l}=await G.get(`/api/asset/${s}/next_page_holders`,{params:o});return l}}const Me={class:"list-decimal list-inside"},Ue=h(" \xA0("),Te={__name:"ListHolders",props:["holders","symbol","asset","decimals","endHolders","offsetForHolders","typeOfHolders","supply"],setup(a){const s=a,o=Z("socket.io"),{t:c}=F(),l=r([]),u=r(!1),f=r(0),g=r([]),v=r(),{width:O}=J(v);function e(t){const m=[];let p=0,I=!1;const L=s.decimals||0;return t.length>20&&(t=t.slice(0,20),I=!0),t.forEach(x=>{const N=x.balance/10**L;p+=N,m.push({value:N,name:x.address})}),I&&m.push({value:s.supply-p,name:"Others"}),m}se(()=>{g.value=[],u.value=s.endHolders,f.value=s.offsetForHolders,l.value=[...s.holders],g.value=e(s.holders)}),D(O,()=>{!v.value||v.value.resize()});function w(t){u.value=t.end,f.value+=t.holders.length,l.value=[...l.value,...t.holders]}async function $(){const t=await Be(o,s.asset,{type:s.typeOfHolders,offset:f.value});w(t)}return(t,m)=>(n(),i("div",null,[_(Fe,{ref_key:"chart",ref:v,class:"h-96 w-full py-8",data:g.value,name:"Holders",symbol:a.symbol},null,8,["data","symbol"]),_(ne,{title:b(c)("holders"),closed:!0},{default:R(()=>[ae([l.value],()=>(n(),i("div",{class:"grid gap-1"},[y("ul",Me,[(n(!0),i(A,null,le(l.value,p=>(n(),i("li",{key:p.address},[_(C,{type:"address",link:p.address},{default:R(()=>[h(k(p.address),1)]),_:2},1032,["link"]),Ue,_(S,{amount:p.balance,decimals:a.decimals,"is-asset":!0},null,8,["amount","decimals"]),h(" "+k(a.symbol)+") ",1)]))),128))]),u.value?H("",!0):(n(),i("a",{key:0,class:"link link-hover text-blue-500 mt-2",onClick:$},k(b(c)("showMoreHolders")),1))])),m,0)]),_:1},8,["title"])]))}};async function j(a,s,o){const{wsConnected:c}=W(M());let l="info";if(o&&(l="next_page_transactions"),c.value)return new Promise(u=>{if(l==="next_page_transactions"){o.asset=s,a.emit(P.LoadNextPageAssetTransactions,o,u);return}a.emit(P.GetAssetData,{asset:s},u)});{const{data:u}=await G.get(`/api/asset/${encodeURIComponent(s)}/${l}`,{params:{...o}});return u}}const Ee={class:"w-full bg-white absolute h-full p-4",style:{"z-index":"1100"}},je={class:"text-right"},ze={key:0,class:"text-center"},Ve={key:1,class:"mt-14 text-center"},Ge={key:2},Ze={class:"mt-10"},Je={key:0,class:"mt-4"},Ke=h(" Total supply: "),Xe=h(" Price: "),qe=h(" Marketcap: "),Qe={key:1,class:"text-center font-bold pt-8"},Ye={__name:"Asset",setup(a){const s=Z("socket.io"),o=z(),c=oe(),{lastUnit:l,view:u}=W(M()),{rates:f}=W(ue()),{t:g}=F(),v=r(!1),O=r({}),e=r({}),w=r(!1),$=r({lastInputsROWID:0,lastOutputsROWID:0}),t=r(!0),m=r(!1),p=r(null),I=r(null),{height:L}=V(),{height:x}=J(I),{y:N}=re(),U=r(c.params.asset),K=ie(()=>`${!w.value&&e.value.name?`Token ${e.value.name} transactions and holders | `:""}${ce}`);de({title:K});function X(d){if(O.value=d,t.value=!0,m.value=!1,d.notFound){U.value=c.params.asset,w.value=!0,v.value=!0;return}if(e.value=E(d,f),v.value=!0,v.value=!0,U.value=d.name,e.value.isPrivate){t.value=!1;return}$.value={lastInputsROWID:d.transactionsData.newLastInputsROWID,lastOutputsROWID:d.transactionsData.newLastOutputsROWID}}async function q(){if(!c.params.asset)return;v.value=!1;const d=await j(s,c.params.asset);X(d)}function Q(d){m.value=d.end,$.value={lastInputsROWID:d.transactionsData.newLastInputsROWID,lastOutputsROWID:d.transactionsData.newLastOutputsROWID},p.value.addNewTransactions(d.transactionsData.unitAssets,d.transactionsData.objTransactions),t.value=!0}async function T(){if(m.value)return;t.value=!1;const d=await j(s,c.params.asset,{lastInputsROWID:$.value.lastInputsROWID,lastOutputsROWID:$.value.lastOutputsROWID});Q(d)}D(N,()=>{N.value+L.value+100>=x.value&&v.value&&t.value&&!w.value&&T()}),D(x,()=>{v.value&&t.value&&x.value<L.value&&!w.value&&T()}),D(f,()=>{v.value&&(e.value=E(O.value,f))}),D(()=>c.params.asset,q,{immediate:!0});function Y(){return l.value?o.push({path:"/"+l.value}):o.push({path:"/"})}return(d,et)=>(n(),i("div",Ee,[y("div",{class:"max-w-6xl mx-auto w-full text-sm md:text-base",ref_key:"el",ref:I},[y("div",je,[y("a",{onClick:Y,class:"link link-hover text-blue-500"},k(b(g)("closeButton")),1)]),v.value?H("",!0):(n(),i("div",ze,[_(ke,{class:"w-20 h-20 inline-block"})])),w.value?(n(),i("div",Ve,"No transactions were found for this asset")):v.value?(n(),i("div",Ge,[y("div",Ze,[_(Ae,{"asset-unit":e.value.assetUnit,name:e.value.name,url:e.value.url,"url-name":e.value.urlName},null,8,["asset-unit","name","url","url-name"])]),e.value.supply?(n(),i("div",Je,[y("div",null,[Ke,_(S,{amount:e.value.supply,"is-asset":!0},null,8,["amount"]),h(k(e.value.name),1)]),e.value.dollarPrice?(n(),i(A,{key:0},[y("div",null,[Xe,_(S,{amount:Number(e.value.dollarPrice.toPrecision(6)),"is-asset":!0,"show-dollar":!0},null,8,["amount"])]),y("div",null,[qe,_(S,{amount:Number(e.value.marketCap.toFixed(2)),"is-asset":!0,"show-dollar":!0},null,8,["amount"])])],64)):H("",!0)])):H("",!0),e.value.isPrivate?(n(),i("div",Qe,k(b(g)("infoAboutPrivateAsset")),1)):(n(),i(A,{key:2},[e.value.holders.length?(n(),B(Te,{key:0,class:"mt-4",holders:e.value.holders,symbol:e.value.name,asset:b(c).params.asset,decimals:e.value.decimals,"end-holders":e.value.endHolders,"offset-for-holders":e.value.offsetForHolders,"type-of-holders":e.value.typeOfHolders,supply:e.value.supply},null,8,["holders","symbol","asset","decimals","end-holders","offset-for-holders","type-of-holders","supply"])):H("",!0),_(we,{class:"mt-12",ref_key:"PL",ref:p,"unit-assets":e.value.transactionsData.unitAssets,"obj-transactions":e.value.transactionsData.objTransactions,address:null,view:b(u)},null,8,["unit-assets","obj-transactions","view"])],64))])):H("",!0)],512)]))}},at={__name:"AssetView",setup(a){return(s,o)=>(n(),B(Ye))}};export{at as default};
